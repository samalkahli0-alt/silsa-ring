<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ูุนุงูุฑุฉ ุนุฑุถ ุงูุจุทุงูุฉ โ SILSA</title>

  <style>
    body{
      margin:0;
      background:#ffeed3;
      font-family:'Tajawal', sans-serif;
      color:#3e000c;
    }

    .wrap{
      max-width:1100px;
      margin:20px auto;
      padding:16px;
    }

    .card{
      background:#fff7ea;
      border:1px solid #f1d7b8;
      border-radius:14px;
      padding:16px;
      margin-bottom:20px;
    }

    #startCalib{
      width:100%;
      padding:12px;
      border:none;
      border-radius:12px;
      background:#b8860b;
      color:white;
      font-size:18px;
      cursor:pointer;
    }

    /* ุดุงุดุฉ ุงููุนุงูุฑุฉ */
    #calibrationScreen{
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.85);
      color:white;
      padding:25px;
      text-align:center;
      z-index:99999;
    }

    #edgeHint{
      margin-bottom:10px;
      font-size:18px;
      text-align:right;
      color:#fff;
      margin-right:20px;
    }

    /* ุงูููุทูุฉ ุงูุชู ุชูุซู ุทุฑู ุงูุฌูุงุฒ */
    #calibrationEdge{
      position:relative;
      width:80vw;
      max-width:450px;
      height:140px;
      margin-left:auto; /* ูุฏูุนูุง ููุทุฑู ุงููููู */
      border-right:3px solid #ffffffaa; /* ููุซู ุญุงูุฉ ุงูุฌูุงุฒ */
      overflow:hidden; /* ูุตู ุงููุฑุช ูุฎุชูู ููุง */
    }

    /* ุงููุฑุช ููุณู */
    #cardBox{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      background:white;
      border:4px solid #3e000c;
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.35);
    }

    /* ุงูุณูุงูุฏุฑ */
    #calibSlider{
      width:100%;
      margin-top:25px;
    }
  </style>

</head>
<body>

<div class="wrap">

  <div class="card">
    <h2>ูุนุงูุฑุฉ ุนุฑุถ ุงูุจุทุงูุฉ</h2>
    <p>ุงุถุบุท ุนูู ุฒุฑ ุงููุนุงูุฑุฉ ุซู ุทุงุจู ุงูุฌุฒุก ุงูุธุงูุฑ ูู ุงููุณุชุทูู ูุน ุนุฑุถ ุงูุจุทุงูุฉ ุชูุงููุง.</p>
    <button id="startCalib">ุจุฏุก ุงููุนุงูุฑุฉ</button>
    <div id="calibStatus" style="margin-top:10px;color:#7e4a55">ูู ุชุชู ุงููุนุงูุฑุฉ ุจุนุฏ</div>
  </div>

</div>

<!-- ุดุงุดุฉ ุงููุนุงูุฑุฉ -->
<div id="calibrationScreen">

  <h2>๐ง ุงููุนุงูุฑุฉ</h2>
  <p>ุถุน ุงูุจุทุงูุฉ ุจุดูู ุนุฑุถู ุจุญูุซ ูุธูุฑ ูุตููุง ุฏุงุฎู ุงูุดุงุดุฉุ ุซู ุทุงุจู ุนุฑุถ ุงูุฌุฒุก ุงูุธุงูุฑ ูุน ุงููุณุชุทูู.</p>

  <div id="edgeHint">โ ุถุน ุญุงูุฉ ุงูุจุทุงูุฉ ููุง</div>

  <div id="calibrationEdge">
    <div id="cardBox"></div>
  </div>

  <input type="range" id="calibSlider">

  <button id="doneCalib"
    style="margin-top:20px;padding:12px;border-radius:12px;
    background:#b8860b;color:white;border:none;font-size:17px;width:100%">
    ุญูุธ ูุฅุบูุงู
  </button>

</div>

<script>

  /***************************************************
   * ุงููุนุงูุฑุฉ ุชุนุชูุฏ ุนูู ุนุฑุถ ุงูุจุทุงูุฉ ุงูุญูููู = 53.98mm
   ***************************************************/
  const CARD_WIDTH_MM = 53.98;   // ุงูุนุฑุถ ุงูุญูููู ููุจุทุงูุฉ
  const CARD_HEIGHT_MM = 85.6;   // ุงูุทูู ุงูุญูููู
  const RATIO = CARD_HEIGHT_MM / CARD_WIDTH_MM; // ุงูุงุฑุชูุงุน = ุงูุนุฑุถ ร ูุฐู ุงููุณุจุฉ

  let scaleFactor = localStorage.scaleFactor ? parseFloat(localStorage.scaleFactor) : 6.8;
  let pxPerMM = scaleFactor;

  const calibScreen  = document.getElementById("calibrationScreen");
  const calibSlider  = document.getElementById("calibSlider");
  const cardBox      = document.getElementById("cardBox");
  const startCalib   = document.getElementById("startCalib");
  const doneCalib    = document.getElementById("doneCalib");
  const calibStatus  = document.getElementById("calibStatus");

  /**************************************
   * ุชุญุฏูุซ ุญุฌู ุงููุฑุช โ ุนุฑุถ + ูุณุจุฉ ูุชูุงุณุจ
   **************************************/
  function updateCardBox(){
    const fullWidthPx = parseFloat(calibSlider.value);
    const fullHeightPx = fullWidthPx * RATIO;

    // ุงูุญุฌู ุงูุญูููู ูููุตู ุงูุธุงูุฑ
    cardBox.style.width  = fullWidthPx + "px";
    cardBox.style.height = fullHeightPx + "px";

    // ูุตู ุงููุฑุช ุฏุงุฎู ุงูุดุงุดุฉ โ ูุตูู ุฎุงุฑุฌ
    cardBox.style.right = -(fullWidthPx / 2) + "px";
  }

  /***********************
   * ุนูุฏ ุจุฏุก ุงููุนุงูุฑุฉ
   ***********************/
  startCalib.addEventListener("click", ()=>{

    // ุงููุฏู ูุณูุญ ุจุฃู ูุตู ุงูุนุฑุถ ุงูู ุงูุญุฌู ุงูุญูููู ูููุง ูุงู ุงูุฌูุงุฒ
    const maxPx = Math.round(window.innerWidth * 2.5);

    calibSlider.min = 50;
    calibSlider.max = maxPx;
    calibSlider.value = 100; // ุจุฏุงูุฉ ุตุบูุฑุฉ ุฌูููุฉ

    updateCardBox();
    calibScreen.style.display = "block";
  });

  calibSlider.addEventListener("input", updateCardBox);

  /***********************
   * ุญูุธ scaleFactor
   ***********************/
  doneCalib.addEventListener("click", ()=>{

    const px = parseFloat(calibSlider.value);

    // ุงูุขู scaleFactor = ูู ุจูุณู ูุณุงูู 1 ููู
    scaleFactor = px / CARD_WIDTH_MM; 
    pxPerMM = scaleFactor;

    localStorage.setItem("scaleFactor", scaleFactor);

    calibStatus.textContent = "โ ุชูุช ุงููุนุงูุฑุฉ ุจูุฌุงุญ";
    calibStatus.style.color = "green";

    calibScreen.style.display = "none";
  });

</script>

</body>
</html>

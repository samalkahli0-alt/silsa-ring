<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ’ Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ù‚Ø§Ø³ Ø§Ù„Ø®Ø§ØªÙ… â€” SILSA</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#ffeed3; --ink:#3e000c; --muted:#7e4a55;
      --card:#fff7ea; --border:#f1d7b8;
      --accent:#b8860b; --accent2:#d4af37;
      --navy:#001f3f; --danger:#c81e1e;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:'Tajawal',system-ui,Arial}
    .wrap{max-width:1100px;margin:24px auto;padding:16px}
    h1{font-size:26px;font-weight:800;margin:0 0 6px}
    .subtitle{color:var(--muted);margin:0 0 18px}
    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
    @media (max-width:880px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:16px}

    label{font-size:14px;color:var(--muted);display:block;margin-bottom:6px}
    /* Ù…Ù‡Ù…: Ù†Ø¬Ø¹Ù„Ù‡Ø§ Ù†Øµ ÙˆÙ„ÙŠØ³ number Ù„ØªØ³Ù…Ø­ Ø¨Ù€ . , Ù« */
    input,select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;
      font-size:16px;background:#fff;outline:none;color:var(--ink)}
    input:focus,select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(212,175,55,.18)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .full{grid-column:1/-1}
    .error{color:var(--danger);font-weight:800;margin-top:8px;min-height:1.5em}
    .laser{color:var(--navy);font-weight:800;margin-top:8px;white-space:pre-line;min-height:2.6em}

    /* Ø§Ù„Ø±Ø³Ù… */
    .canvas-card{display:flex;flex-direction:column;align-items:center;gap:10px}
    svg{max-width:380px;height:auto;display:block}
    .size-label{font-weight:800}
    .ring-stroke{stroke:url(#ringGrad);stroke-width:12;fill:url(#ringFill);filter:drop-shadow(0 6px 12px rgba(62,0,12,.12))}
    .ring-stroke-inner{stroke:#fff;stroke-width:4;fill:none}
    .diamond{filter:drop-shadow(0 3px 6px rgba(0,0,0,.15))}
    @keyframes sparkle{0%{fill:#89CFF0}50%{fill:#bde3fb}100%{fill:#89CFF0}}
    .sparkle{animation:sparkle 1.2s ease-in-out infinite}

    /* Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„Ù…Ù‚Ø§Ø³ */
    .slider-wrap{display:flex;align-items:center;gap:10px;width:100%}
    input[type=range].size{appearance:none;width:100%;height:16px;border-radius:999px;background:#ead8bb;outline:none}
    input[type=range].size::-webkit-slider-thumb{appearance:none;width:26px;height:26px;border-radius:50%;background:var(--accent2);border:2px solid #fff;box-shadow:0 0 0 2px rgba(212,175,55,.35);cursor:pointer}
    input[type=range].size::-moz-range-thumb{width:26px;height:26px;border-radius:50%;background:var(--accent2);border:2px solid #fff;box-shadow:0 0 0 2px rgba(212,175,55,.35);cursor:pointer}

    /* Ù…Ø¹Ø§ÙŠØ±Ø© Ø¨Ø§Ù„Ø³Ù†ØªÙŠÙ…ØªØ± */
    .calib{margin-top:14px}
    .calib .title{font-weight:800;margin-bottom:6px}
    .calib .howto{background:#fff;border:1px dashed var(--border);border-radius:12px;padding:10px;line-height:1.7;color:var(--ink)}
    .calib-inner{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-top:10px}
    .calib .big{appearance:none;width:100%;height:22px;border-radius:16px;background:linear-gradient(90deg,#fff,#e6caa0);outline:none}
    .calib .big::-webkit-slider-thumb{appearance:none;width:34px;height:34px;border-radius:50%;background:var(--accent2);border:3px solid #fff;box-shadow:0 0 0 2px rgba(212,175,55,.3);cursor:pointer}
    .calib .big::-moz-range-thumb{width:34px;height:34px;border-radius:50%;background:var(--accent2);border:3px solid #fff;box-shadow:0 0 0 2px rgba(212,175,55,.3);cursor:pointer}
    .bar{height:42px;background:linear-gradient(90deg,#fff,var(--accent2));border:2px solid var(--accent2);border-radius:21px;width:250px;margin:14px auto;position:relative;transition:width .15s ease}
    .bar::before,.bar::after{content:"";position:absolute;top:-12px;width:3px;height:66px;background:var(--ink)}
    .bar::before{left:0}.bar::after{right:0}
    .hint{font-size:12px;color:var(--muted)}
    .badge{display:inline-block;background:rgba(212,175,55,.14);color:var(--ink);border:1px solid var(--accent2);padding:6px 10px;border-radius:999px;font-size:12px}
    button.reset{background:var(--ink);color:var(--bg);border:none;border-radius:12px;padding:8px 14px;font-family:'Tajawal';cursor:pointer}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ù‚Ø§Ø³ Ø§Ù„Ø®Ø§ØªÙ… â€” SILSA ğŸ’</h1>
    <div class="subtitle">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù…Ù‚Ø§Ø³ ÙˆØ´Ø§Ù‡Ø¯ÙŠ Ø§Ù„Ø®Ø§ØªÙ… Ø¨Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¹Ù„Ù‰ Ø´Ø§Ø´ØªÙƒ. Ø¹Ø§ÙŠÙØ±ÙŠ Ø§Ù„Ù…Ø³Ø·Ø±Ø© <b>Ø¨Ø§Ù„Ø³Ù†ØªÙŠÙ…ØªØ±</b>Ø› Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© ØªØ¨Ù‚Ù‰ Ø¨Ø§Ù„Ù€ mm Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¯Ù‚Ø©.</div>

    <div class="grid">
      <!-- Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª -->
      <div class="card">
        <div class="row">
          <div>
            <label>Ø³Ù…Ø§ÙƒØ© Ø§Ù„ÙØ¶Ø© (mm) â€” ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù„ÙŠØ²Ø± ÙÙ‚Ø·</label>
            <select id="thickness">
              <option>1.0</option><option>1.2</option><option>1.5</option><option>1.75</option><option>2.0</option>
            </select>
          </div>
          <div class="hint" style="align-self:end">ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù‚Ø§Ø³ Ù…Ù† Ø£ÙŠ Ø®Ø§Ù†Ø© Ø£Ùˆ Ù…Ù† Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±</div>
        </div>

        <div class="row" style="margin-top:12px">
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠ (US)</label><input id="us" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 7.5 Ø£Ùˆ 7,5" /></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ (UK)</label><input id="uk" placeholder="Ù…Ø«Ø§Ù„: KÂ½" /></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„ÙØ±Ù†Ø³ÙŠ (FR)</label><input id="fr" inputmode="decimal" placeholder="Ø§Ù„Ù…Ø­ÙŠØ· Ø¨Ø§Ù„Ù€ mm" /></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ÙŠ (JP)</label><input id="jp" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 19" /></div>
          <div><label>Ø§Ù„Ù‚Ø·Ø± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (mm)</label><input id="diameter" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 18.1" /></div>
          <div><label>Ø§Ù„Ù…Ø­ÙŠØ· (mm)</label><input id="circ" inputmode="decimal" placeholder="Ï€ Ã— Ø§Ù„Ù‚Ø·Ø±" /></div>
          <div class="full error" id="error"></div>
          <div class="full laser" id="laser"></div>
        </div>

        <!-- Ù…Ø¹Ø§ÙŠØ±Ø© Ø¨Ø§Ù„Ø³Ù†ØªÙŠÙ…ØªØ± (ÙˆØ§Ø¬Ù‡Ø© ÙÙ‚Ø·) -->
        <div class="card calib">
          <div class="title">ğŸ”§ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© (Ø§Ù„Ø­Ø¬Ù… Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©)</div>
          <div class="howto">
            1) Ø¶Ø¹ÙŠ Ù…Ø³Ø·Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©.<br/>
            2) Ø­Ø±Ù‘ÙƒÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø­ØªÙ‰ ÙŠØ·Ø§Ø¨Ù‚ Ø§Ù„Ø¹Ø±Ø¶ <b id="refText">2.5 Ø³Ù…</b> Ø¨Ø¯Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·Ù‘ÙŠÙ†.<br/>
            3) Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙÙ„Ø§ØªØŒ ÙŠØ·Ø¨Ù‘ÙÙ‚ Ø§Ù„Ø¶Ø¨Ø· ÙˆÙŠÙØ±Ø³Ù… Ø§Ù„Ø®Ø§ØªÙ… Ø¨Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ. (ÙŠÙØ­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§)
          </div>

          <div class="calib-inner">
            <div>
              <label>Ù…Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© (Ø³Ù…)</label>
              <input id="refCm" type="text" value="2.5">
            </div>
            <div>
              <label>ØªÙƒØ¨ÙŠØ± Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø©</label>
              <input id="calibSlider" type="range" min="120" max="1000" step="1" value="250" class="big">
            </div>
            <div style="display:flex;align-items:end;justify-content:flex-end">
              <span class="badge" id="pxBadge">1 Ù…Ù… â‰ˆ â€” Ø¨ÙƒØ³Ù„</span>
            </div>
          </div>

          <div class="full">
            <div id="calibBar" class="bar" style="width:250px"></div>
            <div class="hint" style="margin:6px 0 10px">Ø§Ø³Ø­Ø¨ÙŠ Ø­ØªÙ‰ ÙŠØ·Ø§Ø¨Ù‚ ØªÙ…Ø§Ù…Ù‹Ø§ <b>Ø¹Ø±Ø¶</b> Ø§Ù„Ø´Ø±ÙŠØ· Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø¨Ø§Ù„Ø³Ù†ØªÙŠÙ…ØªØ±.</div>
            <button id="resetCal" class="reset">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø©</button>
          </div>
        </div>
      </div>

      <!-- Ø§Ù„Ø±Ø³Ù… ÙˆØ§Ù„ØªØ­ÙƒÙ… -->
      <div class="card canvas-card">
        <div id="sizeLabel" class="size-label">Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø­Ø§Ù„ÙŠ: â€” (US)</div>
        <svg id="ringSvg" viewBox="0 0 360 360" aria-label="Ø®Ø§ØªÙ… ØªÙØ§Ø¹Ù„ÙŠ">
          <defs>
            <linearGradient id="ringGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#d9d9d9"/><stop offset="50%" stop-color="#f3f3f3"/><stop offset="100%" stop-color="#c6c6c6"/>
            </linearGradient>
            <radialGradient id="ringFill" cx="50%" cy="40%" r="65%">
              <stop offset="0%" stop-color="#ffffff"/><stop offset="60%" stop-color="#f7f7f7"/><stop offset="100%" stop-color="#f0f0f0"/>
            </radialGradient>
          </defs>
          <circle id="outer" class="ring-stroke" cx="180" cy="190" r="60" />
          <circle id="inner" class="ring-stroke-inner" cx="180" cy="190" r="35" />
          <polygon id="diamond" class="diamond sparkle" points="180,90 170,100 180,110 190,100" fill="#89CFF0" stroke="#5a9bd4" stroke-width="2" />
        </svg>
        <div class="slider-wrap">
          <span class="hint">4</span>
          <input id="slider" type="range" min="4" max="14" step="0.5" value="8" class="size" />
          <span class="hint">14</span>
        </div>
        <div class="hint">ØªÙ„Ù…ÙŠØ­: ÙŠÙ…ÙƒÙ†Ùƒ ÙƒØªØ§Ø¨Ø© 7.5 Ø£Ùˆ 7,5 Ø£Ùˆ 7Ù«5 â€” ÙƒÙ„Ù‡Ø§ ØªÙÙ‚Ø¨Ù„.</div>
      </div>
    </div>
  </div>

  <script>
    // Ø«ÙˆØ§Ø¨Øª ÙˆÙ…Ø¹Ø§Ø¯Ù„Ø§Øª
    const PI=Math.PI, US_MIN=4, US_MAX=14;
    const usToDiameter=us=>11.63+0.8128*us; // mm
    const diameterToUs=d=>(d-11.63)/0.8128;
    const diameterToCirc=d=>PI*d;
    const usToFR=us=>diameterToCirc(usToDiameter(us));
    const usToJP=us=>us+12;

    const UK_STEPS=["H","HÂ½","I","IÂ½","J","JÂ½","K","KÂ½","L","LÂ½","M","MÂ½","N","NÂ½","O","OÂ½","P","PÂ½","Q","QÂ½","R","RÂ½","S","SÂ½","T","TÂ½","U","UÂ½","V","VÂ½","W","WÂ½","X","XÂ½","Y","YÂ½","Z","Z+Â½","Z+1"];
    const usToUK=us=>{const i=(us-US_MIN)/(US_MAX-US_MIN)*(UK_STEPS.length-1);return UK_STEPS[Math.max(0,Math.min(UK_STEPS.length-1,Math.round(i)))]};
    const normalizeUK=s=>s.trim().toUpperCase().replace("1/2","Â½");
    const ukToUs=uk=>{const i=UK_STEPS.indexOf(normalizeUK(uk));if(i<0)return null;return US_MIN+(i/(UK_STEPS.length-1))*(US_MAX-US_MIN)};

    // DOM
    const $=id=>document.getElementById(id);
    const el={
      thickness:$("thickness"), us:$("us"), uk:$("uk"), fr:$("fr"), jp:$("jp"), diameter:$("diameter"), circ:$("circ"),
      error:$("error"), laser:$("laser"), slider:$("slider"), sizeLabel:$("sizeLabel"),
      outer:$("outer"), inner:$("inner"), diamond:$("diamond"),
      refCm:$("refCm"), calibSlider:$("calibSlider"), calibBar:$("calibBar"), refText:$("refText"), pxBadge:$("pxBadge"), resetCal:$("resetCal")
    };

    // Ø­Ø§Ù„Ø© Ø¹Ø§Ù…Ø©
    let updating=false;
    let pxPerMM=6.8; // ØªÙØ­ÙØ¸

    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (ÙŠØ¯Ø¹Ù… 7.5 Ùˆ7,5 Ùˆ7Ù«5 ÙˆØ£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©)
    function normalizeNumberString(v){
      if(v==null) return "";
      v=(""+v).trim();
      const arabicDigits={"Ù ":"0","Ù¡":"1","Ù¢":"2","Ù£":"3","Ù¤":"4","Ù¥":"5","Ù¦":"6","Ù§":"7","Ù¨":"8","Ù©":"9"};
      v=v.replace(/[Ù -Ù©]/g,d=>arabicDigits[d]);
      v=v.replace(/[Ù¬Ù«,]/g,"."); // ÙØ§ØµÙ„Ø© Ø¹Ø±Ø¨ÙŠØ©/Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© -> Ù†Ù‚Ø·Ø©
      return v;
    }
    const fmt=(n,d=2)=>Number(n).toFixed(d).replace(/\.0+$/,'').replace(/\.$/,'');
    const tryNum=v=>{v=normalizeNumberString(v); if(!v||v==='.'||v==='-'||v==='-.') return null; const n=Number(v); return Number.isFinite(n)? n: null;};
    function setError(msg){ el.error.textContent=msg||""; if(msg) el.laser.textContent=""; }

    // Ø±Ø³Ù… Ø§Ù„Ø®Ø§ØªÙ… ÙÙ‚Ø· (ÙŠØªØ£Ø«Ø± Ø¨Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø©)
    function drawRing(diameterMM){
      const rPx=(diameterMM/2)*pxPerMM;
      const cx=180, cy=190;
      el.outer.setAttribute("r", rPx);
      el.inner.setAttribute("r", rPx/1.7);
      const dy=cy-rPx-20;
      el.diamond.setAttribute("points", `${cx},${dy-8} ${cx-10},${dy} ${cx},${dy+8} ${cx+10},${dy}`);
    }

    // ØªØ­Ø¯ÙŠØ« ÙƒØ§Ù…Ù„ Ù…Ù† US
    function updateAllFromUS(us){
      if(us<US_MIN||us>US_MAX){ setError("âŒ Ø§Ù„Ù…Ù‚Ø§Ø³ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚ (4 â€“ 14)"); return; }
      setError("");
      const d=usToDiameter(us), c=diameterToCirc(d);
      const fr=c, jp=usToJP(us), uk=usToUK(us);

      updating=true;
      el.us.value=fmt(us,2);
      el.uk.value=uk;
      el.fr.value=fmt(fr,1);
      el.jp.value=fmt(jp,1);
      el.diameter.value=fmt(d,2);
      el.circ.value=fmt(c,1);
      el.slider.value=us;
      updating=false;

      el.sizeLabel.textContent=`Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${fmt(us,1)} (US)`;
      drawRing(d);

      const t=parseFloat(el.thickness.value||"1");
      el.laser.textContent=`Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ù…Ø§ÙƒÙŠÙ†Ø© Ø§Ù„Ù„ÙŠØ²Ø±: ${fmt((d+t)*Math.PI,1)} mm\n(Ø³Ù…Ø§ÙƒØ© Ø§Ù„ÙØ¶Ø©: ${fmt(t,2)} mm)`;
    }

    // â€”â€” Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© Ø¨Ø§Ù„Ø³Ù†ØªÙŠÙ…ØªØ± (ÙˆØ§Ø¬Ù‡Ø© ÙÙ‚Ø·) â€”â€”
    function saveCalibration(){ localStorage.setItem("silsa_pxPerMM", pxPerMM.toFixed(4)); }
    function loadCalibration(){
      const saved=localStorage.getItem("silsa_pxPerMM");
      if(saved){ pxPerMM=parseFloat(saved); el.pxBadge.textContent=`1 Ù…Ù… â‰ˆ ${fmt(pxPerMM,2)} Ø¨ÙƒØ³Ù„`; }
    }
    function applyCalibration(){
      const refCm=parseFloat( normalizeNumberString(el.refCm.value) ) || 2.5; // cm
      const barPx=parseFloat(el.calibSlider.value) || 250;                   // px
      el.refText.textContent=`${fmt(refCm,1)} Ø³Ù…`;
      el.calibBar.style.width=`${barPx}px`;

      pxPerMM = barPx / (refCm * 10); // px Ù„ÙƒÙ„ mm (Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¯Ø§Ø®Ù„ÙŠÙ‹Ø§ mm)
      el.pxBadge.textContent=`1 Ù…Ù… â‰ˆ ${fmt(pxPerMM,2)} Ø¨ÙƒØ³Ù„`;

      // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø®Ø§ØªÙ… ÙÙ‚Ø· (Ù„Ø§ ØªØºÙŠÙ‘Ø± Ø£ÙŠ Ù‚ÙŠÙ…)
      const d=tryNum(el.diameter.value);
      if(d!=null) drawRing(d);

      saveCalibration();
    }

    // Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø³Ø­Ø¨: Ù…Ø¬Ø±Ù‘Ø¯ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø±ÙŠØ· + ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Ø±Ø©ØŒ ÙˆØ§Ù„Ø­Ø³Ø§Ø¨ Ø¹Ù†Ø¯ Ø§Ù„Ø¥ÙÙ„Ø§Øª
    el.calibSlider.addEventListener('input', e=>{
      const px=parseFloat(e.target.value)||0;
      el.calibBar.style.width=`${px}px`;
      const refCm=parseFloat( normalizeNumberString(el.refCm.value) ) || 2.5;
      const previewPxPerMM = px / (refCm*10);
      el.pxBadge.textContent=`1 Ù…Ù… â‰ˆ ${fmt(previewPxPerMM,2)} Ø¨ÙƒØ³Ù„`;
    });
    el.calibSlider.addEventListener('change', applyCalibration);
    el.refCm.addEventListener('input', applyCalibration);

    el.resetCal.addEventListener("click", ()=>{
      localStorage.removeItem("silsa_pxPerMM");
      pxPerMM=6.8; el.refCm.value="2.5"; el.calibSlider.value=250;
      applyCalibration();
      alert("ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ âœ¨");
    });

    // Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (ÙƒÙ„ Ø®Ø§Ù†Ø© â†’ ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ US Ø«Ù… ØªØ­Ø¯ÙŠØ«)
    function handleUS(){ if(updating) return; const n=tryNum(el.us.value); if(n==null) return; updateAllFromUS(n); }
    function handleDiameter(){ if(updating) return; const n=tryNum(el.diameter.value); if(n==null) return; updateAllFromUS(diameterToUs(n)); }
    function handleCirc(){ if(updating) return; const n=tryNum(el.circ.value); if(n==null) return; updateAllFromUS(diameterToUs(n/Math.PI)); }
    function handleFR(){ if(updating) return; const n=tryNum(el.fr.value); if(n==null) return; updateAllFromUS(diameterToUs(n/Math.PI)); }
    function handleJP(){ if(updating) return; const n=tryNum(el.jp.value); if(n==null) return; updateAllFromUS(n-12); }
    function handleUK(){ if(updating) return; const us=ukToUs(el.uk.value); if(us==null) return; updateAllFromUS(us); }
    function handleSlider(){ if(updating) return; updateAllFromUS(parseFloat(el.slider.value)); }
    function handleThickness(){ const d=tryNum(el.diameter.value); if(d==null){ el.laser.textContent=""; return; } const t=parseFloat(el.thickness.value)||1; el.laser.textContent=`Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ù…Ø§ÙƒÙŠÙ†Ø© Ø§Ù„Ù„ÙŠØ²Ø±: ${fmt((d+t)*Math.PI,1)} mm\n(Ø³Ù…Ø§ÙƒØ© Ø§Ù„ÙØ¶Ø©: ${fmt(t,2)} mm)`;}

    el.us.addEventListener('input', handleUS);
    el.uk.addEventListener('input', handleUK);
    el.fr.addEventListener('input', handleFR);
    el.jp.addEventListener('input', handleJP);
    el.diameter.addEventListener('input', handleDiameter);
    el.circ.addEventListener('input', handleCirc);
    el.slider.addEventListener('input', handleSlider);
    el.thickness.addEventListener('change', handleThickness);

    // Ø¨Ø¯Ø¡
    loadCalibration();     // ÙŠØ³ØªØ±Ø¬Ø¹ pxPerMM (Ø¥Ù† ÙˆÙØ¬Ø¯)
    updateAllFromUS(8);    // ÙŠÙ…Ù„Ø£ Ø§Ù„Ù‚ÙŠÙ… ÙˆÙŠØ±Ø³Ù…
    applyCalibration();    // ÙŠØ·Ø¨Ù‘Ù‚ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© ÙˆÙŠØ±Ø³Ù… Ø§Ù„Ø®Ø§ØªÙ… ÙÙ‚Ø·
  </script>
</body>
</html>

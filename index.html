<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ’ Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ù‚Ø§Ø³ Ø§Ù„Ø®Ø§ØªÙ… â€” SILSA</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#ffeed3; --ink:#3e000c; --muted:#7e4a55;
  --card:#fff7ea; --border:#f1d7b8;
  --accent:#b8860b; --accent2:#d4af37;
  --navy:#001f3f; --danger:#c81e1e;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);font-family:'Tajawal',system-ui,Arial}
.wrap{max-width:1100px;margin:24px auto;padding:16px}
.title{font-size:26px;font-weight:800;margin:0 0 6px}
.subtitle{color:var(--muted);margin:0 0 18px}
.grid{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
@media (max-width:880px){.grid{grid-template-columns:1fr}}
.card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:16px}

label{font-size:14px;color:var(--muted);display:block;margin-bottom:6px}
input,select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;font-size:16px;background:#fff;outline:none;color:var(--ink)}
input:focus,select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(212,175,55,.18)}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.full{grid-column:1/-1}
.error{color:var(--danger);font-weight:800;margin-top:8px;min-height:1.5em}
.laser{color:var(--navy);font-weight:800;margin-top:8px;white-space:pre-line;min-height:2.6em}

/* Ø§Ù„Ø±Ø³Ù… */
.canvas-card{display:flex;flex-direction:column;align-items:center;gap:10px}
svg{max-width:380px;width:100%;height:auto;display:block}
.size-label{font-weight:800}

/* 3D ring */
.ring-shadow{
  fill:url(#ringFill);
  stroke:url(#ringGrad);
  stroke-width:12;
  filter:drop-shadow(0 10px 20px rgba(0,0,0,.22)) drop-shadow(0 0 14px rgba(184,134,11,.12));
}
.ring-inner{stroke:#fff;stroke-width:4;fill:none}
.ring-outline{stroke:var(--ink);stroke-width:3;fill:none}

/* Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„Ù…Ù‚Ø§Ø³ (ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ) */
.slider-wrap{display:flex;align-items:center;gap:10px;width:100%}
input[type=range].size{appearance:none;width:100%;height:14px;border-radius:999px;background:#ead8bb;outline:none}
input[type=range].size::-webkit-slider-thumb{appearance:none;width:24px;height:24px;border-radius:50%;background:var(--accent2);border:2px solid #fff;box-shadow:0 0 0 2px rgba(212,175,55,.35);cursor:pointer}
input[type=range].size::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:var(--accent2);border:2px solid #fff;box-shadow:0 0 0 2px rgba(212,175,55,.35);cursor:pointer}

.hint{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
  <div class="wrap">
    <h1 class="title">Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ù‚Ø§Ø³ Ø§Ù„Ø®Ø§ØªÙ… â€” SILSA ğŸ’</h1>
    <div class="subtitle">ÙŠØªÙ… Ø¶Ø¨Ø· Ø­Ø¬Ù… Ø§Ù„Ø®Ø§ØªÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„ÙŠÙØ¹Ø±Ø¶ Ø¨Ø§Ù„Ø­Ø¬Ù… Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠ Ø¹Ù„Ù‰ Ø´Ø§Ø´ØªÙƒ.</div>

    <div class="grid">
      <!-- Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª -->
      <div class="card">
        <div class="row">
          <div>
            <label>Ø³Ù…Ø§ÙƒØ© Ø§Ù„ÙØ¶Ø© (mm)</label>
            <select id="thickness">
              <option>1.0</option><option>1.2</option><option>1.5</option><option>1.75</option><option>2.0</option>
            </select>
          </div>
          <div style="align-self:end" class="hint">ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù„ÙŠØ²Ø± ÙÙ‚Ø·</div>
        </div>
        <div class="row" style="margin-top:12px">
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠ (US)</label><input id="us" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 7.5" /></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ (UK)</label><input id="uk" placeholder="Ù…Ø«Ø§Ù„: KÂ½" /></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„ÙØ±Ù†Ø³ÙŠ (FR)</label><input id="fr" inputmode="decimal" placeholder="Ø§Ù„Ù…Ø­ÙŠØ· Ø¨Ø§Ù„Ù€ mm" /></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ÙŠ (JP)</label><input id="jp" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 19" /></div>
          <div><label>Ø§Ù„Ù‚Ø·Ø± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (mm)</label><input id="diameter" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 18.1" /></div>
          <div><label>Ø§Ù„Ù…Ø­ÙŠØ· (mm)</label><input id="circ" inputmode="decimal" placeholder="Ï€ Ã— Ø§Ù„Ù‚Ø·Ø±" /></div>
          <div class="full error" id="error"></div>
          <div class="full laser" id="laser"></div>
        </div>
      </div>

      <!-- Ø§Ù„Ø±Ø³Ù… ÙˆØ§Ù„ØªØ­ÙƒÙ… -->
      <div class="card canvas-card">
        <div id="sizeLabel" class="size-label">Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø­Ø§Ù„ÙŠ: â€” (US)</div>
        <svg id="ringSvg" viewBox="0 0 360 360" aria-label="Ø®Ø§ØªÙ… ØªÙØ§Ø¹Ù„ÙŠ">
          <defs>
            <linearGradient id="ringGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#c5c5c5"/><stop offset="50%" stop-color="#f3f3f3"/><stop offset="100%" stop-color="#9e9e9e"/>
            </linearGradient>
            <radialGradient id="ringFill" cx="50%" cy="40%" r="65%">
              <stop offset="0%" stop-color="#fff9f9"/><stop offset="60%" stop-color="#f2f2f2"/><stop offset="100%" stop-color="#dadada"/>
            </radialGradient>
          </defs>
          <circle id="outer" class="ring-shadow"  cx="180" cy="190" r="60" />
          <circle id="inner" class="ring-inner"   cx="180" cy="190" r="35" />
          <circle id="outline" class="ring-outline" cx="180" cy="190" r="66" />
        </svg>
        <div class="slider-wrap">
          <span class="hint">4</span>
          <input id="slider" type="range" min="4" max="14" step="0.5" value="8" class="size" />
          <span class="hint">14</span>
        </div>
        <div class="hint">âœ¨ ÙŠØªÙ… Ø§Ù„Ø¶Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§Ø› ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù‚Ø§Ø³ Ù…Ù† Ø£ÙŠ Ø®Ø§Ù†Ø© Ø£Ùˆ Ù…Ù† Ø§Ù„Ø´Ø±ÙŠØ·</div>
      </div>
    </div>
  </div>

  <script>
    // Ø«ÙˆØ§Ø¨Øª ÙˆÙ…Ø¹Ø§Ø¯Ù„Ø§Øª
    const PI=Math.PI, US_MIN=4, US_MAX=14;
    const usToDiameter=us=>11.63+0.8128*us;
    const diameterToUs=d=>(d-11.63)/0.8128;
    const diameterToCirc=d=>PI*d;
    const usToFR=us=>diameterToCirc(usToDiameter(us));
    const usToJP=us=>us+12;

    const UK_STEPS=["H","HÂ½","I","IÂ½","J","JÂ½","K","KÂ½","L","LÂ½","M","MÂ½","N","NÂ½","O","OÂ½","P","PÂ½","Q","QÂ½","R","RÂ½","S","SÂ½","T","TÂ½","U","UÂ½","V","VÂ½","W","WÂ½","X","XÂ½","Y","YÂ½","Z","Z+Â½","Z+1"];
    const usToUK=us=>{const i=(us-US_MIN)/(US_MAX-US_MIN)*(UK_STEPS.length-1);return UK_STEPS[Math.max(0,Math.min(UK_STEPS.length-1,Math.round(i)))]};
    const normalizeUK=s=>s.trim().toUpperCase().replace("1/2","Â½");
    const ukToUs=uk=>{const i=UK_STEPS.indexOf(normalizeUK(uk));if(i<0)return null;return US_MIN+(i/(UK_STEPS.length-1))*(US_MAX-US_MIN)};

    // Ø¹Ù†Ø§ØµØ± DOM
    const $=id=>document.getElementById(id);
    const el={
      thickness:$("thickness"), us:$("us"), uk:$("uk"), fr:$("fr"), jp:$("jp"),
      diameter:$("diameter"), circ:$("circ"),
      error:$("error"), laser:$("laser"), slider:$("slider"), sizeLabel:$("sizeLabel"),
      outer:$("outer"), inner:$("inner"), outline:$("outline")
    };

    // Ø­Ø§Ù„Ø© Ø¹Ø§Ù…Ø©
    let updating=false;
    let pxPerMM=6.8; // Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© Ø§Ù„Ø°ÙƒÙŠØ©

    const fmt=(n,d=2)=>Number(n).toFixed(d).replace(/\.0+$/,'').replace(/\.$/,'');
    const tryNum=v=>{ if(v==null) return null; v=(""+v).trim(); if(!v || v==='.'||v==='-'||v==='-.') return null; const n=Number(v); return Number.isFinite(n)? n : null; };
    function setError(msg){ el.error.textContent=msg||""; if(msg) el.laser.textContent=""; }

    // â€”â€” Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© Ø§Ù„Ø°ÙƒÙŠØ© (ØªÙ„Ù‚Ø§Ø¦ÙŠØ©) â€”â€”
    function detectPPI(){
      const dpr = window.devicePixelRatio || 1;
      const hw = Math.max(window.screen.width, window.screen.height) * dpr; // Ø¹Ø±Ø¶ Ø§Ù„Ù‡Ø§Ø±Ø¯ÙˆÙŠØ± Ø¨Ø§Ù„Ø¨ÙƒØ³Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ
      // Ø£Ø´Ù‡Ø± Ø£Ø¬Ù‡Ø²Ø© Apple/Ø£Ø¨Ø¹Ø§Ø¯ Ø´Ø§Ø¦Ø¹Ø© (Ù…Ø·Ø§Ø¨Ù‚Ø© Ø£Ù‚Ø±Ø¨ Ø¹Ø±Ø¶ Ù„Ù„Ù‡Ø§Ø±Ø¯ÙˆÙŠØ±)
      const candidates = [
        {w:1170, ppi:460},   // iPhone 12/13/14
        {w:1179, ppi:460},   // iPhone 14 Pro/15 Pro (ØªÙ‚Ø±ÙŠØ¨)
        {w:1125, ppi:458},   // iPhone X/XS/11 Pro
        {w:828,  ppi:326},   // iPhone XR/11
        {w:750,  ppi:326},   // iPhone 6/7/8/SE2
        {w:1080, ppi:400},   // ÙƒØ«ÙŠØ± Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ Ù…ØªÙˆØ³Ø·Ø© (ØªÙ‚Ø±ÙŠØ¨ÙŠ)
        {w:1440, ppi:500},   // Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ Ø£Ø¹Ù„Ù‰ (ØªÙ‚Ø±ÙŠØ¨ÙŠ)
        {w:1536, ppi:264},   // iPad 9.7/10.2 (Retina)
        {w:2048, ppi:264},   // iPad 10.5/11/12.9 Ø¹Ø±Ø¶ Ø£Ù‚ØµØ±
        {w:2732, ppi:264},   // iPad Pro 12.9 (Ø§Ù„Ø·ÙˆÙŠÙ„)
      ];
      let best = null, bestDiff = Infinity;
      for(const c of candidates){
        const diff = Math.abs(hw - c.w);
        if(diff < bestDiff){ bestDiff = diff; best = c; }
      }
      // Ù„Ùˆ Ù‚Ø±ÙŠØ¨ Ø¨Ù…Ø§ ÙŠÙƒÙÙŠ (Â±20px) Ù†Ø«Ù‚ Ø¨Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
      if(best && bestDiff <= 20) return best.ppi;

      // fallback Ù…Ø­Ø³Ù‘Ù†: DPR * 96 (CSS inch)
      return dpr * 96;
    }

    function autoCalibrate(){
      const ppi = detectPPI();              // Ù†Ù‚Ø§Ø·/Ø¨ÙˆØµØ©
      pxPerMM = ppi / 25.4;                 // Ø¨ÙƒØ³Ù„ Ù„ÙƒÙ„ Ù…Ù„Ù…
      // Ø£Ø¹ÙØ¯ Ø§Ù„Ø±Ø³Ù… Ø¨Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ù‚Ø·Ø± (Ø¥Ù† ÙˆÙØ¬Ø¯)
      const d = tryNum(el.diameter.value) ?? usToDiameter(parseFloat(el.slider.value)||8);
      drawRing(d);
    }

    // Ø±Ø³Ù… Ø§Ù„Ø®Ø§ØªÙ… ÙÙ‚Ø· (ÙŠØªØ£Ø«Ø± Ø¨Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø©)
    function drawRing(diameterMM){
      const rPx = (diameterMM/2) * pxPerMM;
      el.outer.setAttribute("r", rPx);
      el.inner.setAttribute("r", rPx/1.7);
      el.outline.setAttribute("r", rPx+6);
    }

    // ØªØ­Ø¯ÙŠØ« ÙƒØ§Ù…Ù„ Ù…Ù† US
    function updateAllFromUS(us){
      if(us<US_MIN || us>US_MAX){ setError("âŒ Ø§Ù„Ù…Ù‚Ø§Ø³ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚ (4 â€“ 14)"); return; }
      setError("");
      const d = usToDiameter(us), c = diameterToCirc(d);
      const fr=c, jp=usToJP(us), uk=usToUK(us);

      updating=true;
      el.us.value=fmt(us,2);
      el.uk.value=uk;
      el.fr.value=fmt(fr,1);
      el.jp.value=fmt(jp,1);
      el.diameter.value=fmt(d,2);
      el.circ.value=fmt(c,1);
      el.slider.value=us;
      updating=false;

      el.sizeLabel.textContent = `Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${fmt(us,1)} (US)`;
      drawRing(d);

      const t=parseFloat(el.thickness.value||"1");
      const laserVal=(d+t)*Math.PI;
      el.laser.textContent = `Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ù…Ø§ÙƒÙŠÙ†Ø© Ø§Ù„Ù„ÙŠØ²Ø±: ${fmt(laserVal,1)} mm\n(Ø³Ù…Ø§ÙƒØ© Ø§Ù„ÙØ¶Ø©: ${fmt(t,2)} mm)`;
    }

    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
    el.us.addEventListener('input', ()=>{ if(updating) return; const n=tryNum(el.us.value); if(n==null) return; updateAllFromUS(n); });
    el.uk.addEventListener('input', ()=>{ if(updating) return; const us=ukToUs(el.uk.value); if(us==null) return; updateAllFromUS(us); });
    el.fr.addEventListener('input', ()=>{ if(updating) return; const n=tryNum(el.fr.value); if(n==null) return; updateAllFromUS(diameterToUs(n/Math.PI)); });
    el.jp.addEventListener('input', ()=>{ if(updating) return; const n=tryNum(el.jp.value); if(n==null) return; updateAllFromUS(n-12); });
    el.diameter.addEventListener('input', ()=>{ if(updating) return; const n=tryNum(el.diameter.value); if(n==null) return; updateAllFromUS(diameterToUs(n)); });
    el.circ.addEventListener('input', ()=>{ if(updating) return; const n=tryNum(el.circ.value); if(n==null) return; updateAllFromUS(diameterToUs(n/Math.PI)); });
    el.slider.addEventListener('input', ()=>{ if(updating) return; updateAllFromUS(parseFloat(el.slider.value)); });
    el.thickness.addEventListener('change', ()=>{ const d=tryNum(el.diameter.value); if(d==null){ el.laser.textContent=""; return; } const t=parseFloat(el.thickness.value)||1; el.laser.textContent=`Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ù…Ø§ÙƒÙŠÙ†Ø© Ø§Ù„Ù„ÙŠØ²Ø±: ${fmt((d+t)*Math.PI,1)} mm\n(Ø³Ù…Ø§ÙƒØ© Ø§Ù„ÙØ¶Ø©: ${fmt(t,2)} mm)`; });

    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù†Ø¯ ØªØºÙŠÙ‘Ø± Ø§Ù„Ø§ØªØ¬Ø§Ù‡/Ø§Ù„Ø­Ø¬Ù…
    window.addEventListener('orientationchange', ()=> setTimeout(autoCalibrate, 200));
    window.addEventListener('resize',            ()=> setTimeout(autoCalibrate, 200));

    // Ø¨Ø¯Ø¡
    updateAllFromUS(8);
    autoCalibrate();
  </script>
</body>
</html>

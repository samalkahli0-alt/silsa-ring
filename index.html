<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>๐ ูุญุงูุงุฉ ููุงุณ ุงูุฎุงุชู โ SILSA</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #ffeed3;
      --ink: #3e000c;
      --muted: #7e4a55;
      --card: #fff7ea;
      --border: #f1d7b8;
      --accent: #b8860b;
      --accent-2: #d4af37;
      --danger: #c81e1e;
      --navy: #001f3f;
    }

    * {
      box-sizing: border-box
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--ink);
      font-family: 'Tajawal', system-ui;
    }

    .wrap {
      max-width: 1100px;
      margin: 24px auto;
      padding: 16px
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 18px;
      margin-bottom: 18px;
    }

    /* ุฑูู ุงูุฎุงุชู ุงููุจูุฑ ุฏุงุฎู ุงูุฏุงุฆุฑุฉ */
    #ringValueUS {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -65%);
      font-size: 36px;
      font-weight: 800;
      color: #3e000c;
      text-shadow: 0 0 6px rgba(0, 0, 0, 0.25);
      pointer-events: none;
    }

    /* ุฑูู ุงูููููุชุฑ */
    #ringValueMM {
      position: absolute;
      top: 58%;
      left: 50%;
      transform: translate(-50%, 0);
      font-size: 15px;
      font-weight: 600;
      color: #3e000c;
      opacity: .9;
      pointer-events: none;
    }

    /* ุณูุงุณุฉ ุชูุจูุฑ/ุชุตุบูุฑ ุงูุฏุงุฆุฑุฉ */
    .ring-stroke,
    .ring-stroke-inner {
      transition: r .25s ease;
    }
  </style>
</head>

<body>

  <div class="wrap">
    <h1 class="title">๐ ุงุนุฑู ููุงุณู</h1>

    <!-- (ููุณ ุจุงูู ุงูุตูุญุฉ ุชุจุนู: ุงูุชุนูููุงุชุ ุงูุณูุงูุฏุฑุ ุงููุฏุฎูุงุชโฆ)
       ุงุชุฑูู ููุง ูู ุจุฏูู ุชุบููุฑ -->
    <div class="card">
      <h3>๐ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู</h3>
      <div class="step-box">
        <b>1)</b> ุงุถุบุท<b> โุจุฏุก ุงููุนุงูุฑุฉโ.</b><br>
        <b>2)</b> ุถุน <b> โุงูุจุทุงูู ุงูุจูููู ุงู ุจุทุงูู ุงูููููโ.</b> ุจุงูุนุฑุถุ ุนูู ุงูุดุงุดุฉ.<br>
        <b>3)</b> ุทุงุจู ูุตู ุงูุจุทุงูุฉ ูุน ุงููุฑุจุน ุงูุฃุจูุถ.<br>
        <b>4)</b> ุญุฑูู ุงูุณูุงูุฏุฑ ุญุชู ูุชุทุงุจู ุงูุญุฌู ุชูุงููุง.<br>
        <b>5)</b> ุงุถุบุท ุญูุธ ูุฅุบูุงู.<br>
      </div>
      <button id="startCalib">ุจุฏุก ุงููุนุงูุฑุฉ</button>
      <div id="calibStatus" style="margin-top:8px;color:var(--muted)">ูู ุชุชู ุงููุนุงูุฑุฉ ุจุนุฏ</div>
    </div>

    <div class="grid">

      <!-- ๐ฅ ุงูุฅุฑุดุงุฏุงุช ุงููุถุงูุฉ (ููุง ุทูุจุช) -->
      <div class="card" style="background:#fffdfa;border:1px solid #f0d9b8">
        <h3 style="margin-top:0;font-size:18px;font-weight:800;color:var(--ink)">๐ ุฅุฑุดุงุฏุงุช ูุนุฑูุฉ ุงูููุงุณ</h3>

        <div style="font-size:14.5px;line-height:1.8;color:var(--muted)">
          โข ุจุนุฏ ุงููุนุงูุฑุฉ .<br>
          โข ุถุน ุฎุงุชูู ููู ุงูุฏุงุฆุฑุฉ ุงูุฏุงุฎููุฉ.<br>
          โข ุฅุฐุง ุทุงุจูุช ุงูุฏุงุฆุฑุฉ ุฎุงุชูู โฌ ูุฐุง ููุงุณู.<br>
          โข ุฅุฐุง ูุงูุช ุตุบูุฑุฉ โฌ ุงุฑูุน ุงูููุงุณ ูููููุง.<br>
          โข ุฅุฐุง ูุงูุช ูุจูุฑุฉ โฌ ุงูุฒู ุงูููุงุณ ูููููุง.<br>
        </div>
      </div>


      <!-- ุงูุฑุณู -->
      <div class="card">
        <div id="sizeLabel" style="font-weight:800;font-size:18px;margin-bottom:10px">
          ุงูููุงุณ ุงูุญุงูู: โ (US)
        </div>

        <div style="position:relative; width:100%; max-width:380px; margin:auto;">

          <svg id="ringSvg" viewBox="0 0 360 360">
            <circle id="outer" class="ring-stroke" cx="180" cy="190" r="60" />
            <circle id="inner" class="ring-stroke-inner" cx="180" cy="190" r="35" />

            <polygon id="diamond" class="diamond" points="180,90 170,100 180,110 190,100" stroke="#5a9bd4"
              stroke-width="2" fill="#89CFF0" />
          </svg>

          <!-- ุงูุฑูู ุงููุจูุฑ (US) -->
          <div id="ringValueUS">8</div>

          <!-- ุงูุฑูู ุงูุตุบูุฑ (mm) -->
          <div id="ringValueMM">16.92 mm</div>

        </div>


        <input id="slider" type="range" min="4" max="14" step="0.5" value="8" />
      </div>

      <!-- ุงููุฏุฎูุงุช -->
      <div class="card">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">

          <div><label>ุงูููุงุณ ุงูุฃูุฑููู (US)</label><input id="us" inputmode="decimal"></div>
          <div><label>ุงูููุงุณ ุงูุจุฑูุทุงูู (UK)</label><input id="uk"></div>
          <div><label>ุงูููุงุณ ุงููุฑูุณู (FR)</label><input id="fr" inputmode="decimal"></div>
          <div><label>ุงูููุงุณ ุงููุงุจุงูู (JP)</label><input id="jp" inputmode="decimal"></div>
          <div><label>ุงููุทุฑ ุงูุฏุงุฎูู (mm)</label><input id="diameter" inputmode="decimal"></div>
          <div><label>ุงููุญูุท (mm)</label><input id="circ" inputmode="decimal"></div>

          <div id="error" style="color:var(--danger);font-weight:bold"></div>
          <div id="laser" style="color:var(--navy);font-weight:bold"></div>
        </div>
      </div>

    </div>
  </div>

  <!-- ุดุงุดุฉ ุงููุนุงูุฑุฉ -->
  <div id="calibrationScreen">
    <div id="calibCard">
      <h2>๐ง ุงููุนุงูุฑุฉ</h2>
      <p>ุทุงุจู ุงููุณุชุทูู ูุน <b>ูุตู ุงูุจุทุงูุฉ</b> ููู ุจุงูุนุฑุถ.</p>

      <div id="calibrationRow">
        <div id="cardViewport">
          <div id="cardBox"></div>
          <div id="halfLine"></div>
        </div>

        <div id="hintBox">
          <span>ุถุน ุงูุจุทุงูุฉ ููุง ุนูู ุงูุดุงุดุฉ</span>
          <span class="arrow">โ</span>
        </div>
      </div>

      <input type="range" id="calibSlider">

      <button id="doneCalib" style="margin-top:16px;padding:12px;border-radius:12px;
        background:var(--accent);color:white;border:none;font-size:17px;width:100%">
        ุญูุธ ูุฅุบูุงู
      </button>
    </div>
  </div>

  <script>
    /************* ูุนุงูุฑุฉ ูุตู ุงูุถูุน ุงูุทููู *************/
    const calibScreen = document.getElementById("calibrationScreen");
    const calibSlider = document.getElementById("calibSlider");
    const cardBox = document.getElementById("cardBox");
    const cardViewport = document.getElementById("cardViewport");
    const halfLine = document.getElementById("halfLine");
    const startCalib = document.getElementById("startCalib");
    const doneCalib = document.getElementById("doneCalib");
    const calibStatus = document.getElementById("calibStatus");

    const CARD_LONG_MM = 85.6;
    const CARD_SHORT_MM = 53.98;
    const CARD_RATIO = CARD_SHORT_MM / CARD_LONG_MM;

    let scaleFactor = localStorage.scaleFactor ? parseFloat(localStorage.scaleFactor) : 6.8;
    let pxPerMM = scaleFactor;

    function updateCardBoxFromSlider() {
      const fullLongPx = parseFloat(calibSlider.value);
      const fullShortPx = fullLongPx * CARD_RATIO;

      cardBox.style.width = fullLongPx + "px";
      cardBox.style.height = fullShortPx + "px";

      const halfLongPx = fullLongPx / 2;

      cardViewport.style.width = halfLongPx + "px";
      cardViewport.style.height = fullShortPx + "px";

      cardBox.style.right = -(fullLongPx / 2) + "px";
      cardBox.style.top = "50%";
      cardBox.style.transform = "translateY(-50%)";

      halfLine.style.height = fullShortPx + "px";
    }

    startCalib.addEventListener("click", () => {
      const maxPx = Math.round(window.innerWidth * 2.0);

      calibSlider.min = 140;
      calibSlider.max = maxPx;
      calibSlider.value = Math.round((140 + maxPx) / 2);

      updateCardBoxFromSlider();
      calibScreen.style.display = "block";
    });

    calibSlider.addEventListener("input", updateCardBoxFromSlider);

    doneCalib.addEventListener("click", () => {
      const fullLongPx = parseFloat(calibSlider.value);
      scaleFactor = fullLongPx / CARD_LONG_MM;
      pxPerMM = scaleFactor;

      localStorage.setItem("scaleFactor", scaleFactor);

      calibStatus.textContent = "โ ุชูุช ุงููุนุงูุฑุฉ ุจูุฌุงุญ";
      calibStatus.style.color = "lightgreen";

      calibScreen.style.display = "none";

      const currentUS = parseFloat(document.getElementById("us").value) || 8;
      updateAllFromUS(currentUS);
    });

    /************* ุญุณุงุจุงุช ุงูุฎุงุชู *************/
    const PI = Math.PI;
    const US_MIN = 4, US_MAX = 14;

    const usToDiameter = us => 11.63 + 0.8128 * us;
    const diameterToUs = d => (d - 11.63) / 0.8128;
    const diameterToCirc = d => PI * d;
    const usToJP = us => us + 12;

    const UK_STEPS = [
      "H", "Hยฝ", "I", "Iยฝ", "J", "Jยฝ", "K", "Kยฝ", "L", "Lยฝ", "M", "Mยฝ",
      "N", "Nยฝ", "O", "Oยฝ", "P", "Pยฝ", "Q", "Qยฝ", "R", "Rยฝ", "S", "Sยฝ",
      "T", "Tยฝ", "U", "Uยฝ", "V", "Vยฝ", "W", "Wยฝ", "X", "Xยฝ", "Y", "Yยฝ",
      "Z", "Z+ยฝ", "Z+1"
    ];

    const usToUK = (us) => {
      const idx = (us - US_MIN) / (US_MAX - US_MIN) * (UK_STEPS.length - 1);
      return UK_STEPS[Math.round(Math.min(Math.max(idx, 0), UK_STEPS.length - 1))];
    };

    const normalizeUK = s => s.trim().toUpperCase().replace("1/2", "ยฝ");
    const ukToUs = uk => {
      const i = UK_STEPS.indexOf(normalizeUK(uk));
      if (i < 0) return null;
      return US_MIN + (i / (UK_STEPS.length - 1)) * (US_MAX - US_MIN);
    };

    const $ = id => document.getElementById(id);
    const el = {
      us: $("us"), uk: $("uk"), fr: $("fr"), jp: $("jp"),
      diameter: $("diameter"), circ: $("circ"),
      error: $("error"), laser: $("laser"),
      slider: $("slider"), sizeLabel: $("sizeLabel"),
      outer: $("outer"), inner: $("inner"), diamond: $("diamond")
    };

    let updating = false;

    const fmt = (n, d = 2) => Number(n).toFixed(d).replace(/\.0+$/, '').replace(/\.$/, '');

    /* โ ููุง ุงูุชุนุฏูู ุงูููู: ุงูุฏุงุฆุฑุฉ ุงูุฏุงุฎููุฉ = ุงููุทุฑ ุงูุญูููู */
    function drawRing(diameterMM) {
      const cx = 180, cy = 190;

      // ูุตู ุงููุทุฑ ุงูุญูููู ุจุงูู px (ุงูุฏุงุฎูู)
      const innerR = (diameterMM / 2) * pxPerMM;

      // ุณูุงูุฉ ุงูุฎุงุชู (ุดูู ููุท) ูุซูุงู 6px
      const bandThickness = 6;
      const outerR = innerR + bandThickness;

      // ุงูุฏุงุฆุฑุฉ ุงูุฏุงุฎููุฉ = ุงููุทุฑ ุงูุญูููู
      el.inner.setAttribute('r', innerR);

      // ุงูุฏุงุฆุฑุฉ ุงูุฎุงุฑุฌูุฉ ุฃูุจุฑ ุจุดูู ูุฅุทุงุฑ
      el.outer.setAttribute('r', outerR);

      // ูุญุท ุงูุฃููุงุณุฉ ููู ุงูุฎุงุชู ุนูุฏ ุงูุญุงูุฉ ุงูุฎุงุฑุฌูุฉ
      const dy = cy - outerR - 20;
      el.diamond.setAttribute('points',
        `${cx},${dy - 8} ${cx - 10},${dy} ${cx},${dy + 8} ${cx + 10},${dy}`
      );
    }

    function updateAllFromUS(us) {
      if (us < US_MIN || us > US_MAX) {
        el.error.textContent = "โ ุงูููุงุณ ุฎุงุฑุฌ ุงููุทุงู (4 โ 14)";
        return;
      }
      el.error.textContent = "";

      const d = usToDiameter(us);
      const c = diameterToCirc(d);
      const jp = usToJP(us);
      const uk = usToUK(us);

      updating = true;
      el.us.value = fmt(us, 2);
      el.uk.value = uk;
      el.fr.value = fmt(c, 1);
      el.jp.value = fmt(jp, 1);
      el.diameter.value = fmt(d, 2);
      el.circ.value = fmt(c, 1);
      el.slider.value = us;
      updating = false;

      el.sizeLabel.textContent = `ุงูููุงุณ ุงูุญุงูู: ${fmt(us, 1)} (US)`;
      drawRing(d);
      el.laser.textContent = `ุงููููุฉ ุงููุณุชุฎุฏูุฉ ูููุงูููุฉ: ${fmt(c, 1)} mm`;
    }

    const tryNum = v => {
      if (!v) return null;
      v = ("" + v).trim();
      const n = Number(v);
      return Number.isFinite(n) ? n : null;
    };

    el.us.addEventListener('input', () => { if (updating) return; let n = tryNum(el.us.value); if (n != null) updateAllFromUS(n) });
    el.uk.addEventListener('input', () => { if (updating) return; let us = ukToUs(el.uk.value); if (us != null) updateAllFromUS(us) });
    el.fr.addEventListener('input', () => { if (updating) return; let n = tryNum(el.fr.value); if (n != null) updateAllFromUS(diameterToUs(n / PI)) });
    el.jp.addEventListener('input', () => { if (updating) return; let n = tryNum(el.jp.value); if (n != null) updateAllFromUS(n - 12) });
    el.diameter.addEventListener('input', () => { if (updating) return; let n = tryNum(el.diameter.value); if (n != null) updateAllFromUS(diameterToUs(n)) });
    el.circ.addEventListener('input', () => { if (updating) return; let n = tryNum(el.circ.value); if (n != null) updateAllFromUS(diameterToUs(n / PI)) });
    el.slider.addEventListener('input', () => { if (!updating) updateAllFromUS(parseFloat(el.slider.value)) });

    updateAllFromUS(8);
  </script>
<script>
let currentUS = 8;
let targetUS = 8;

const ringUS = document.getElementById("ringValueUS");
const ringMM = document.getElementById("ringValueMM");

function animateSmooth(){
  currentUS += (targetUS - currentUS) * 0.12;

  // ุชุญุฏูุซ ุงูุฃุฑูุงู
  ringUS.textContent = currentUS.toFixed(2).replace(/\.00$/,'');
  
  const d = usToDiameter(currentUS);
  const mmValue = d.toFixed(2);
  ringMM.textContent = mmValue + " mm";

  // ุชุญุฏูุซ ุงูุฎุงุชู
  drawRing(d);

  // ุชุญุฏูุซ ุจุงูู ุงูููุงุณุงุช ุชุฏุฑูุฌู
  el.us.value = currentUS.toFixed(2);
  el.fr.value = (Math.PI * d).toFixed(1);
  el.jp.value = (currentUS+12).toFixed(1);
  el.diameter.value = d.toFixed(2);
  el.circ.value = (Math.PI * d).toFixed(1);
  el.sizeLabel.textContent = `ุงูููุงุณ ุงูุญุงูู: ${currentUS.toFixed(2)} (US)`;

  requestAnimationFrame(animateSmooth);
}

el.slider.addEventListener("input", ()=>{
  targetUS = parseFloat(el.slider.value);
});

animateSmooth();
</script>

</body>

</html>

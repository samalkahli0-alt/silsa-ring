<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ’ Ø§Ø¹Ø±Ù Ù…Ù‚Ø§Ø³Ùƒ â€” SILSA</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#ffeed3;
      --ink:#3e000c;
      --muted:#7e4a55;
      --card:#fff7ea;
      --border:#f1d7b8;
      --accent:#b8860b;
      --accent-2:#d4af37;
      --danger:#c81e1e;
      --navy:#001f3f;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--ink);
      font-family:'Tajawal', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .wrap{max-width:1100px;margin:24px auto;padding:16px}
    .title{
      font-size:28px;
      font-weight:800;
      margin:0 0 14px;
      display:flex;
      gap:10px;
      align-items:center
    }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      padding:18px;
      margin-bottom:18px;
    }

    .step-box{
      background:white;
      padding:14px;
      border-radius:12px;
      border:1px solid var(--border);
      margin-top:8px;
      font-size:15px;
      line-height:1.8;
    }

    #startCalib{
      margin-top:14px;
      padding:12px;
      border-radius:12px;
      background:var(--accent);
      color:white;
      border:none;
      font-size:17px;
      width:100%;
      cursor:pointer;
    }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
    .grid{
      display:grid;
      grid-template-columns:1.2fr .8fr;
      gap:16px;
    }
    @media(max-width:900px){
      .grid{grid-template-columns:1fr;}
    }

    svg{max-width:380px;height:auto;margin:auto;display:block}

    .ring-stroke{
      stroke:#3e000c !important;
      stroke-width:6 !important;
      fill:transparent;
    }
    .ring-stroke-inner{
      stroke:#3e000c !important;
      stroke-width:3 !important;
      fill:white;
    }

    .diamond{animation:sparkle 1.3s infinite}
    @keyframes sparkle{
      0%{fill:#89CFF0}
      50%{fill:#bde3fb}
      100%{fill:#89CFF0}
    }

    input,select{
      width:100%;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:12px;
      font-size:16px;
      background:white;
      color:var(--ink);
    }

    input[type=range]{
      appearance:none;
      width:100%;
      height:6px;
      border-radius:999px;
      background:#ead8bb;
    }
    input[type=range]::-webkit-slider-thumb{
      appearance:none;
      width:18px;
      height:18px;
      border-radius:50%;
      background:var(--accent-2);
      border:2px solid white;
    }

    /* Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© */
    #calibrationScreen{
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.85);
      backdrop-filter:blur(4px);
      padding:24px 16px;
      color:white;
      text-align:center;
      z-index:9999;
    }

    #calibrationInner{
      max-width:480px;
      margin:0 auto;
    }

    #calibrationRow{
      margin:20px 0;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:18px;
    }

    #cardBox{
      background:white;
      border:4px solid #3e000c;  /* Ø¥Ø·Ø§Ø± Ø¹Ù†Ø§Ø¨ÙŠ */
      border-radius:10px;
      box-shadow:0 0 12px rgba(0,0,0,.35);
    }

    #hintBox{
      display:flex;
      flex-direction:row;
      align-items:center;
      gap:6px;
      font-size:15px;
      white-space:nowrap;
    }

    #hintBox .arrow{
      font-size:20px;
      line-height:1;
    }

    #calibSlider{
      appearance:none;
      width:100%;
      height:6px;
      border-radius:999px;
      background:#ead8bb;
    }
    #calibSlider::-webkit-slider-thumb{
      appearance:none;
      width:22px;
      height:22px;
      border-radius:50%;
      background:var(--accent-2);
      border:3px solid white;
    }
  </style>
</head>

<body>
  <div class="wrap">

    <h1 class="title">ğŸ’ Ø§Ø¹Ø±Ù Ù…Ù‚Ø§Ø³Ùƒ</h1>

    <div class="card">
      <h3>ğŸ“˜ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3>
      <div class="step-box">
        <b>1)</b> Ø§Ø¶ØºØ· Ø²Ø± <b>â€œØ¨Ø¯Ø¡ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø©â€</b>.<br>
        <b>2)</b> Ø¶Ø¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø´ÙƒÙ„ Ø¹Ø±Ø¶ÙŠ Ø¹Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„Ø¬ÙˆØ§Ù„ØŒ Ø¨Ø­ÙŠØ« Ù†ØµÙÙ‡Ø§ ÙÙˆÙ‚ Ø§Ù„Ø´Ø§Ø´Ø© ÙˆÙ†ØµÙÙ‡Ø§ Ø®Ø§Ø±Ø¬Ù‡Ø§.<br>
        <b>3)</b> Ø¶Ø¹ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙÙˆÙ‚ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø£Ø¨ÙŠØ¶ØŒ ÙˆØ­Ø§ÙˆÙ„ ØªØ·Ø§Ø¨Ù‚Ù‡ ØªÙ…Ø§Ù…Ù‹Ø§ (Ù†ÙØ³ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©).<br>
        <b>4)</b> Ø­Ø±Ù‘Ùƒ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ø­ØªÙ‰ ÙŠØµØ¨Ø­ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ù†ÙØ³ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ.<br>
        <b>5)</b> Ø§Ø¶ØºØ· Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚.<br><br>
        Ø¨Ø¹Ø¯Ù‡Ø§ ÙŠØ¸Ù‡Ø± Ø§Ù„Ø®Ø§ØªÙ… Ø¨Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ ğŸ™ŒğŸ’›
      </div>
      <button id="startCalib">Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø©</button>
      <div id="calibStatus" style="margin-top:8px;color:var(--muted)">Ù„Ù… ØªØªÙ… Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© Ø¨Ø¹Ø¯</div>
    </div>

    <div class="grid">

      <!-- Ø§Ù„Ø±Ø³Ù… Ø£ÙˆÙ„Ø§Ù‹ -->
      <div class="card">
        <div id="sizeLabel" style="font-weight:800;font-size:18px;margin-bottom:10px">
          Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø­Ø§Ù„ÙŠ: â€” (US)
        </div>

        <svg id="ringSvg" viewBox="0 0 360 360">
          <circle id="outer" class="ring-stroke" cx="180" cy="190" r="60" />
          <circle id="inner" class="ring-stroke-inner" cx="180" cy="190" r="35" />
          <polygon id="diamond" class="diamond"
            points="180,90 170,100 180,110 190,100"
            stroke="#5a9bd4" stroke-width="2" fill="#89CFF0" />
        </svg>

        <input id="slider" type="range" min="4" max="14" step="0.5" value="8" />
        <div style="font-size:13px;color:var(--muted)">Ø§Ø³Ø­Ø¨ Ø§Ù„Ø´Ø±ÙŠØ· Ø£Ùˆ ØºÙŠÙ‘Ø± Ø£ÙŠ Ø®Ø§Ù†Ø© Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰</div>
      </div>

      <!-- Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª -->
      <div class="card">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">

          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠ (US)</label><input id="us" inputmode="decimal"></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ (UK)</label><input id="uk"></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„ÙØ±Ù†Ø³ÙŠ (FR)</label><input id="fr" inputmode="decimal"></div>
          <div><label>Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ÙŠ (JP)</label><input id="jp" inputmode="decimal"></div>
          <div><label>Ø§Ù„Ù‚Ø·Ø± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (mm)</label><input id="diameter" inputmode="decimal"></div>
          <div><label>Ø§Ù„Ù…Ø­ÙŠØ· (mm)</label><input id="circ" inputmode="decimal"></div>

          <div id="error" style="color:#c81e1e;font-weight:bold"></div>
          <div id="laser" style="color:#001f3f;font-weight:bold"></div>

        </div>
      </div>

    </div>
  </div>

  <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© -->
  <div id="calibrationScreen">
    <div id="calibrationInner">
      <h2>ğŸ”§ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø©</h2>
      <p>Ø¶Ø¹ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙÙˆÙ‚ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ØŒ Ø«Ù… Ø­Ø±Ù‘Ùƒ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ø­ØªÙ‰ ÙŠØ·Ø§Ø¨Ù‚ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø§Ù„Ø­Ø¬Ù….</p>

      <div id="calibrationRow">
        <!-- Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø«Ù„ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© -->
        <div id="cardBox"></div>

        <!-- Ø§Ù„Ù†Øµ Ù…Ø¹ Ø§Ù„Ø³Ù‡Ù… Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ù…Ø±Ø¨Ø¹ -->
        <div id="hintBox">
          <span>Ø¶Ø¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù‡Ù†Ø§</span>
          <span class="arrow">â†</span>
        </div>
      </div>

      <input type="range" id="calibSlider">

      <button id="doneCalib"
        style="margin-top:20px;padding:12px;border-radius:12px;
        background:var(--accent);color:white;border:none;font-size:17px;width:100%">
        Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚
      </button>
    </div>
  </div>

  <script>
    /************* Ù…Ø¹Ø§ÙŠØ±Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¶) *************/
    const calibScreen   = document.getElementById("calibrationScreen");
    const calibSlider   = document.getElementById("calibSlider");
    const cardBox       = document.getElementById("cardBox");
    const startCalib    = document.getElementById("startCalib");
    const doneCalib     = document.getElementById("doneCalib");
    const calibStatus   = document.getElementById("calibStatus");

    // Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†Ùƒ / Ù‡ÙˆÙŠØ©) Ø£ÙÙ‚ÙŠØ©:
    // Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ù„Ø·ÙˆÙ„ Ø§Ù„Ø£ÙÙ‚ÙŠ) = 85.6mm
    // Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ (Ø§Ù„Ø¶Ù„Ø¹ Ø§Ù„Ù‚ØµÙŠØ±) = 53.98mm
    const CARD_LONG_MM  = 85.6;     // Ø§Ù„Ø¶Ù„Ø¹ Ø§Ù„Ø·ÙˆÙŠÙ„
    const CARD_SHORT_MM = 53.98;    // Ø§Ù„Ø¶Ù„Ø¹ Ø§Ù„Ù‚ØµÙŠØ± (Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©)
    const HALF_LONG_MM  = CARD_LONG_MM / 2;  // Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Ø§Ù„Ù„ÙŠ Ù†Ø¹Ø§ÙŠØ±Ù‡)

    // scaleFactor = ÙƒÙ… Ø¨ÙƒØ³Ù„ Ù„ÙƒÙ„ 1mm
    let scaleFactor = localStorage.scaleFactor ? parseFloat(localStorage.scaleFactor) : 6.8;
    let pxPerMM     = scaleFactor; // ØªÙØ³ØªØ®Ø¯Ù… ÙÙŠ Ø±Ø³Ù… Ø§Ù„Ø®Ø§ØªÙ…

    // ØªØ­Ø¯ÙŠØ« Ø´ÙƒÙ„ Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© (ÙŠÙ…Ø«Ù„ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ)
    function updateCardBoxFromSlider(){
      const halfWidthPx = parseFloat(calibSlider.value); // Ø¹Ø±Ø¶ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø¨Ø§Ù„Ø¨ÙƒØ³Ù„

      // Ù†Ø³ØªØ®Ø¯Ù… scale Ù…Ø¤Ù‚Øª Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø¨Ù†ÙØ³ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
      const tempScale   = halfWidthPx / HALF_LONG_MM; // Ø¨ÙƒØ³Ù„ Ù„ÙƒÙ„ 1mm (Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©)
      const heightPx    = CARD_SHORT_MM * tempScale;  // Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø§Ù„Ø¨ÙƒØ³Ù„

      cardBox.style.width  = halfWidthPx + "px";  // ÙŠÙ…Ø«Ù„ Ù†ØµÙ Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
      cardBox.style.height = heightPx    + "px";  // ÙŠÙ…Ø«Ù„ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ù†Ø³Ø¨Ø© ÙˆØªÙ†Ø§Ø³Ø¨
    }

    startCalib.addEventListener("click", ()=>{
      // Ù†Ø®Ù„ÙŠ Ù…Ø¯Ù‰ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± ÙŠÙ†Ø§Ø³Ø¨ Ø£ØºÙ„Ø¨ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©
      const maxHalfWidthPx = Math.round(window.innerWidth * 0.9);

      calibSlider.min   = 40;   // ØµØºÙŠØ± Ù…Ø¨Ø¯Ø¦ÙŠØ§Ù‹
      calibSlider.max   = maxHalfWidthPx;
      calibSlider.value = Math.round(maxHalfWidthPx * 0.5); // Ù‚ÙŠÙ…Ø© Ù…ØªÙˆØ³Ø·Ø©

      updateCardBoxFromSlider();
      calibScreen.style.display = "block";
    });

    calibSlider.addEventListener("input", updateCardBoxFromSlider);

    doneCalib.addEventListener("click", ()=>{
      const halfWidthPx = parseFloat(calibSlider.value);

      // Ø§Ù„Ø¢Ù† Ù†Ø­Ø³Ø¨ scaleFactor Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©:
      // Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ = HALF_LONG_MM mm
      // Ù†ØµÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© = halfWidthPx px
      scaleFactor = halfWidthPx / HALF_LONG_MM; // px Ù„ÙƒÙ„ 1mm
      pxPerMM     = scaleFactor;

      localStorage.setItem("scaleFactor", scaleFactor);

      calibStatus.textContent = "âœ” ØªÙ…Øª Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© Ø¨Ù†Ø¬Ø§Ø­";
      calibStatus.style.color = "green";

      calibScreen.style.display = "none";

      // Ù†Ø¹ÙŠØ¯ Ø±Ø³Ù… Ø§Ù„Ø®Ø§ØªÙ… Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ« pxPerMM
      const currentUS = parseFloat(document.getElementById("us").value) || 8;
      updateAllFromUS(currentUS);
    });

    /************* Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª ÙˆØ§Ù„Ø®Ø§ØªÙ… *************/
    const PI = Math.PI;
    const US_MIN = 4, US_MAX = 14;

    const usToDiameter   = us => 11.63 + 0.8128 * us;
    const diameterToUs   = d  => (d - 11.63) / 0.8128;
    const diameterToCirc = d  => PI * d;
    const usToJP         = us => us + 12;

    const UK_STEPS = [
      "H","HÂ½","I","IÂ½","J","JÂ½","K","KÂ½","L","LÂ½","M","MÂ½",
      "N","NÂ½","O","OÂ½","P","PÂ½","Q","QÂ½","R","RÂ½","S","SÂ½",
      "T","TÂ½","U","UÂ½","V","VÂ½","W","WÂ½","X","XÂ½","Y","YÂ½",
      "Z","Z+Â½","Z+1"
    ];

    const usToUK = (us)=>{
      const idx=(us-US_MIN)/(US_MAX-US_MIN)*(UK_STEPS.length-1);
      return UK_STEPS[Math.round(Math.min(Math.max(idx,0),UK_STEPS.length-1))];
    };

    const normalizeUK = s => s.trim().toUpperCase().replace("1/2","Â½");
    const ukToUs = uk => {
      const i = UK_STEPS.indexOf(normalizeUK(uk));
      if(i<0) return null;
      return US_MIN + (i/(UK_STEPS.length-1))*(US_MAX-US_MIN);
    };

    const $ = id => document.getElementById(id);
    const el = {
      us: $("us"), uk: $("uk"), fr: $("fr"), jp: $("jp"),
      diameter: $("diameter"), circ: $("circ"),
      error: $("error"), laser: $("laser"),
      slider: $("slider"), sizeLabel: $("sizeLabel"),
      outer: $("outer"), inner: $("inner"), diamond: $("diamond")
    };

    let updating = false;

    const fmt = (n,d=2)=>
      Number(n).toFixed(d).replace(/\.0+$/,'').replace(/\.$/,'');

    function drawRing(diameterMM){
      const rPx = (diameterMM/2) * pxPerMM;
      const cx = 180, cy = 190;

      el.outer.setAttribute('r', rPx);
      el.inner.setAttribute('r', rPx/1.7);

      const dy = cy - rPx - 20;
      el.diamond.setAttribute('points',
        `${cx},${dy-8} ${cx-10},${dy} ${cx},${dy+8} ${cx+10},${dy}`
      );
    }

    function updateAllFromUS(us){
      if(us < US_MIN || us > US_MAX){
        el.error.textContent = "âŒ Ø§Ù„Ù…Ù‚Ø§Ø³ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚ (4 â€” 14)";
        return;
      }
      el.error.textContent = "";

      const d  = usToDiameter(us);
      const c  = diameterToCirc(d);
      const jp = usToJP(us);
      const uk = usToUK(us);

      updating = true;
      el.us.value       = fmt(us,2);
      el.uk.value       = uk;
      el.fr.value       = fmt(c,1);
      el.jp.value       = fmt(jp,1);
      el.diameter.value = fmt(d,2);
      el.circ.value     = fmt(c,1);
      el.slider.value   = us;
      updating = false;

      el.sizeLabel.textContent = `Ø§Ù„Ù…Ù‚Ø§Ø³ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${fmt(us,1)} (US)`;
      drawRing(d);
      el.laser.textContent = `Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„Ù„Ù…Ø§ÙƒÙŠÙ†Ø©: ${fmt(c,1)} mm`;
    }

    const tryNum = v =>{
      if(!v) return null;
      v = (""+v).trim();
      const n = Number(v);
      return Number.isFinite(n) ? n : null;
    };

    el.us.addEventListener('input',()=>{
      if(updating) return;
      let n = tryNum(el.us.value);
      if(n != null) updateAllFromUS(n);
    });

    el.uk.addEventListener('input',()=>{
      if(updating) return;
      let us = ukToUs(el.uk.value);
      if(us != null) updateAllFromUS(us);
    });

    el.fr.addEventListener('input',()=>{
      if(updating) return;
      let n = tryNum(el.fr.value);
      if(n != null) updateAllFromUS(diameterToUs(n/PI));
    });

    el.jp.addEventListener('input',()=>{
      if(updating) return;
      let n = tryNum(el.jp.value);
      if(n != null) updateAllFromUS(n-12);
    });

    el.diameter.addEventListener('input',()=>{
      if(updating) return;
      let n = tryNum(el.diameter.value);
      if(n != null) updateAllFromUS(diameterToUs(n));
    });

    el.circ.addEventListener('input',()=>{
      if(updating) return;
      let n = tryNum(el.circ.value);
      if(n != null) updateAllFromUS(diameterToUs(n/PI));
    });

    el.slider.addEventListener('input',()=>{
      if(!updating) updateAllFromUS(parseFloat(el.slider.value));
    });

    // Ø¨Ø¯Ø§ÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    updateAllFromUS(8);
  </script>
</body>
</html>
